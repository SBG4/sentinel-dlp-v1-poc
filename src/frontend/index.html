<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SentinelDLP | Sensitive Information Detection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --bg-card: #15151f;
            --border-color: #2a2a3a;
            --text-primary: #e8e8f0;
            --text-secondary: #8888a0;
            --text-muted: #55556a;
            --accent-cyan: #00d4ff;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --accent-orange: #f97316;
            --glow-cyan: rgba(0, 212, 255, 0.15);
            --glow-purple: rgba(139, 92, 246, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Navigation */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }
        
        .logo {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .logo-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }
        
        .logo-sub {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .nav-menu {
            flex: 1;
            padding: 16px 12px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            margin-bottom: 4px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, var(--glow-cyan), var(--glow-purple));
            color: var(--accent-cyan);
            border: 1px solid rgba(0, 212, 255, 0.2);
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
            opacity: 0.8;
        }
        
        .nav-item.active .nav-icon {
            opacity: 1;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 32px;
            background: var(--bg-primary);
            min-height: 100vh;
        }
        
        .page-header {
            margin-bottom: 32px;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--stat-color, var(--accent-cyan));
        }
        
        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
        }
        
        /* Upload Zone */
        .upload-zone {
            border: 2px dashed var(--border-color);
            border-radius: 16px;
            padding: 60px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: var(--bg-tertiary);
        }
        
        .upload-zone:hover, .upload-zone.dragover {
            border-color: var(--accent-cyan);
            background: var(--glow-cyan);
        }
        
        .upload-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 20px;
            opacity: 0.5;
        }
        
        .upload-text {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .upload-hint {
            font-size: 13px;
            color: var(--text-muted);
        }
        
        /* Text Input */
        .text-input-area {
            width: 100%;
            min-height: 200px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            resize: vertical;
            outline: none;
            transition: border-color 0.2s ease;
        }
        
        .text-input-area:focus {
            border-color: var(--accent-cyan);
        }
        
        /* Buttons */
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.3);
        }
        
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background: var(--bg-card);
            border-color: var(--accent-cyan);
        }
        
        .btn-danger {
            background: var(--accent-red);
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }
        
        .form-input:focus {
            border-color: var(--accent-cyan);
        }
        
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238888a0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
        }
        
        /* Severity Badges */
        .severity-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .severity-low {
            background: rgba(16, 185, 129, 0.15);
            color: var(--accent-green);
        }
        
        .severity-medium {
            background: rgba(245, 158, 11, 0.15);
            color: var(--accent-yellow);
        }
        
        .severity-high {
            background: rgba(249, 115, 22, 0.15);
            color: var(--accent-orange);
        }
        
        .severity-critical {
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
        }
        
        /* Results Section */
        .results-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        .score-ring {
            width: 180px;
            height: 180px;
            margin: 0 auto 24px;
            position: relative;
        }
        
        .score-ring svg {
            transform: rotate(-90deg);
        }
        
        .score-ring-bg {
            fill: none;
            stroke: var(--border-color);
            stroke-width: 12;
        }
        
        .score-ring-progress {
            fill: none;
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }
        
        .score-value-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        
        .score-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 48px;
            font-weight: 700;
        }
        
        .score-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Dimension Bars */
        .dimension-item {
            margin-bottom: 16px;
        }
        
        .dimension-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }
        
        .dimension-name {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .dimension-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 600;
        }
        
        .dimension-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .dimension-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        /* Table */
        .incidents-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .incidents-table th {
            text-align: left;
            padding: 14px 16px;
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .incidents-table td {
            padding: 16px;
            font-size: 13px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }
        
        .incidents-table tr:hover td {
            background: var(--bg-tertiary);
        }
        
        .filename-cell {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
        }
        
        .timestamp-cell {
            color: var(--text-muted);
            font-size: 12px;
        }
        
        /* Findings List */
        .finding-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .finding-category {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .finding-description {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .finding-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .example-tag {
            background: var(--bg-primary);
            padding: 4px 10px;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-muted);
        }
        
        /* Department Grid */
        .dept-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .dept-item {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dept-name {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        /* Actions List */
        .action-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .action-item:last-child {
            border-bottom: none;
        }
        
        .action-icon {
            width: 20px;
            height: 20px;
            color: var(--accent-cyan);
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .action-text {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* Loading States */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 15, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1000;
        }
        
        .loading-text {
            margin-top: 24px;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1100;
        }
        
        .toast {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px 20px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }
        
        .toast-success {
            border-color: var(--accent-green);
        }
        
        .toast-error {
            border-color: var(--accent-red);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        
        .empty-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            opacity: 0.3;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 16px;
        }
        
        .tab {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }
        
        .tab:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--glow-cyan), var(--glow-purple));
            color: var(--accent-cyan);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .results-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            .main-content {
                margin-left: 0;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // API Configuration
        const API_BASE = 'http://localhost:8000';
        
        // Icons as SVG components
        const Icons = {
            Scanner: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M3 7V5a2 2 0 0 1 2-2h2" />
                    <path d="M17 3h2a2 2 0 0 1 2 2v2" />
                    <path d="M21 17v2a2 2 0 0 1-2 2h-2" />
                    <path d="M7 21H5a2 2 0 0 1-2-2v-2" />
                    <line x1="7" y1="12" x2="17" y2="12" />
                </svg>
            ),
            Dashboard: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <rect x="3" y="3" width="7" height="9" />
                    <rect x="14" y="3" width="7" height="5" />
                    <rect x="14" y="12" width="7" height="9" />
                    <rect x="3" y="16" width="7" height="5" />
                </svg>
            ),
            Settings: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <circle cx="12" cy="12" r="3" />
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                </svg>
            ),
            Upload: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="17 8 12 3 7 8" />
                    <line x1="12" y1="3" x2="12" y2="15" />
                </svg>
            ),
            Check: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <polyline points="20 6 9 17 4 12" />
                </svg>
            ),
            Alert: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="8" x2="12" y2="12" />
                    <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
            ),
            Shield: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
            ),
            FileText: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14 2 14 8 20 8" />
                    <line x1="16" y1="13" x2="8" y2="13" />
                    <line x1="16" y1="17" x2="8" y2="17" />
                    <polyline points="10 9 9 9 8 9" />
                </svg>
            ),
            Trash: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <polyline points="3 6 5 6 21 6" />
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                </svg>
            ),
            ArrowRight: () => (
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12" />
                    <polyline points="12 5 19 12 12 19" />
                </svg>
            )
        };
        
        // Utility functions
        const getSeverityClass = (level) => {
            const classes = {
                'LOW': 'severity-low',
                'MEDIUM': 'severity-medium',
                'HIGH': 'severity-high',
                'CRITICAL': 'severity-critical'
            };
            return classes[level] || 'severity-low';
        };
        
        const getSeverityColor = (level) => {
            const colors = {
                'LOW': '#10b981',
                'MEDIUM': '#f59e0b',
                'HIGH': '#f97316',
                'CRITICAL': '#ef4444'
            };
            return colors[level] || '#10b981';
        };
        
        const getDimensionColor = (score) => {
            if (score >= 80) return '#ef4444';
            if (score >= 60) return '#f97316';
            if (score >= 40) return '#f59e0b';
            if (score >= 20) return '#00d4ff';
            return '#10b981';
        };
        
        const formatTimestamp = (ts) => {
            const date = new Date(ts);
            return date.toLocaleString();
        };
        
        // Toast Component
        const Toast = ({ message, type, onClose }) => {
            useEffect(() => {
                const timer = setTimeout(onClose, 4000);
                return () => clearTimeout(timer);
            }, [onClose]);
            
            return (
                <div className={`toast toast-${type}`}>
                    <span style={{ width: 20, height: 20 }}>
                        {type === 'success' ? <Icons.Check /> : <Icons.Alert />}
                    </span>
                    <span>{message}</span>
                </div>
            );
        };
        
        // Score Ring Component
        const ScoreRing = ({ score, level }) => {
            const circumference = 2 * Math.PI * 70;
            const offset = circumference - (score / 100) * circumference;
            const color = getSeverityColor(level);
            
            return (
                <div className="score-ring">
                    <svg width="180" height="180">
                        <circle className="score-ring-bg" cx="90" cy="90" r="70" />
                        <circle 
                            className="score-ring-progress" 
                            cx="90" 
                            cy="90" 
                            r="70"
                            stroke={color}
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                        />
                    </svg>
                    <div className="score-value-container">
                        <div className="score-number" style={{ color }}>{score}</div>
                        <div className="score-label">{level}</div>
                    </div>
                </div>
            );
        };
        
        // Scanner Page
        const ScannerPage = ({ addToast, onAnalysisComplete }) => {
            const [inputMode, setInputMode] = useState('file');
            const [textInput, setTextInput] = useState('');
            const [dragOver, setDragOver] = useState(false);
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            
            const analyzeText = async (text, filename = 'pasted-text.txt', filetype = 'txt', filesize = `${text.length} bytes`) => {
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/api/analyze/text`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            document_text: text,
                            filename,
                            filetype,
                            filesize
                        })
                    });
                    
                    if (!response.ok) {
                        const error = await response.json();
                        throw new Error(error.detail || 'Analysis failed');
                    }
                    
                    const data = await response.json();
                    setResult(data);
                    onAnalysisComplete();
                    addToast(`Analysis complete: ${data.sensitivity_level}`, 'success');
                } catch (err) {
                    addToast(err.message, 'error');
                } finally {
                    setLoading(false);
                }
            };
            
            const handleFileDrop = async (e) => {
                e.preventDefault();
                setDragOver(false);
                
                const file = e.dataTransfer?.files[0] || e.target.files?.[0];
                if (!file) return;
                
                const text = await file.text();
                analyzeText(text, file.name, file.name.split('.').pop(), `${file.size} bytes`);
            };
            
            const handleSubmit = () => {
                if (textInput.trim()) {
                    analyzeText(textInput);
                }
            };
            
            const dimensionLabels = {
                pii: 'PII (Personal Identifiable Info)',
                financial: 'Financial Information',
                strategic_business: 'Strategic Business',
                intellectual_property: 'Intellectual Property',
                legal_compliance: 'Legal & Compliance',
                operational_security: 'Operational Security',
                hr_employee: 'HR & Employee Data'
            };
            
            return (
                <div>
                    <div className="page-header">
                        <h1 className="page-title">Document Scanner</h1>
                        <p className="page-subtitle">Upload or paste documents to analyze for sensitive information</p>
                    </div>
                    
                    {loading && (
                        <div className="loading-overlay">
                            <div className="loading-spinner"></div>
                            <div className="loading-text">Analyzing document with Claude AI...</div>
                        </div>
                    )}
                    
                    {!result ? (
                        <div className="card">
                            <div className="tabs">
                                <div 
                                    className={`tab ${inputMode === 'file' ? 'active' : ''}`}
                                    onClick={() => setInputMode('file')}
                                >
                                    Upload File
                                </div>
                                <div 
                                    className={`tab ${inputMode === 'text' ? 'active' : ''}`}
                                    onClick={() => setInputMode('text')}
                                >
                                    Paste Text
                                </div>
                            </div>
                            
                            {inputMode === 'file' ? (
                                <div 
                                    className={`upload-zone ${dragOver ? 'dragover' : ''}`}
                                    onDragOver={(e) => { e.preventDefault(); setDragOver(true); }}
                                    onDragLeave={() => setDragOver(false)}
                                    onDrop={handleFileDrop}
                                    onClick={() => document.getElementById('file-input').click()}
                                >
                                    <div className="upload-icon">
                                        <Icons.Upload />
                                    </div>
                                    <div className="upload-text">Drop file here or click to browse</div>
                                    <div className="upload-hint">Supports: TXT, CSV, JSON, XML, HTML, MD, LOG, PY, JS, YAML</div>
                                    <input 
                                        type="file" 
                                        id="file-input" 
                                        style={{ display: 'none' }} 
                                        onChange={handleFileDrop}
                                        accept=".txt,.csv,.json,.xml,.html,.md,.log,.py,.js,.ts,.yaml,.yml,.ini,.conf,.cfg"
                                    />
                                </div>
                            ) : (
                                <div>
                                    <textarea 
                                        className="text-input-area"
                                        placeholder="Paste document content here..."
                                        value={textInput}
                                        onChange={(e) => setTextInput(e.target.value)}
                                    />
                                    <div style={{ marginTop: 16, display: 'flex', justifyContent: 'flex-end' }}>
                                        <button 
                                            className="btn btn-primary" 
                                            onClick={handleSubmit}
                                            disabled={!textInput.trim()}
                                        >
                                            <Icons.Scanner /> Analyze Document
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    ) : (
                        <div>
                            <div style={{ marginBottom: 20, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                <h2 style={{ fontSize: 20, fontWeight: 600 }}>Analysis Results</h2>
                                <button className="btn btn-secondary" onClick={() => { setResult(null); setTextInput(''); }}>
                                    Scan Another Document
                                </button>
                            </div>
                            
                            <div className="results-container">
                                <div className="card">
                                    <div className="card-title" style={{ marginBottom: 24 }}>Overall Assessment</div>
                                    <ScoreRing score={result.overall_sensitivity_score} level={result.sensitivity_level} />
                                    <div style={{ textAlign: 'center', marginBottom: 24 }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: 13, marginBottom: 8 }}>
                                            Confidence: {(result.confidence * 100).toFixed(0)}%
                                        </div>
                                        <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: 13, color: 'var(--text-secondary)' }}>
                                            {result.filename}
                                        </div>
                                    </div>
                                    
                                    <div className="card-title" style={{ marginBottom: 16 }}>Dimension Scores</div>
                                    {Object.entries(result.dimension_scores).map(([key, value]) => (
                                        <div className="dimension-item" key={key}>
                                            <div className="dimension-header">
                                                <span className="dimension-name">{dimensionLabels[key] || key}</span>
                                                <span className="dimension-score" style={{ color: getDimensionColor(value) }}>{value}</span>
                                            </div>
                                            <div className="dimension-bar">
                                                <div 
                                                    className="dimension-bar-fill" 
                                                    style={{ 
                                                        width: `${value}%`,
                                                        background: getDimensionColor(value)
                                                    }}
                                                />
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                
                                <div>
                                    <div className="card">
                                        <div className="card-title" style={{ marginBottom: 16 }}>Department Relevance</div>
                                        <div className="dept-grid">
                                            {Object.entries(result.department_relevance).map(([dept, level]) => (
                                                <div className="dept-item" key={dept}>
                                                    <span className="dept-name">{dept.replace('_', '/')}</span>
                                                    <span className={`severity-badge ${getSeverityClass(level)}`}>{level}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    {result.regulatory_concerns?.length > 0 && result.regulatory_concerns[0] !== 'NONE' && (
                                        <div className="card">
                                            <div className="card-title" style={{ marginBottom: 16 }}>Regulatory Concerns</div>
                                            <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap' }}>
                                                {result.regulatory_concerns.map((reg, i) => (
                                                    <span key={i} className="severity-badge severity-high">{reg}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    
                                    <div className="card">
                                        <div className="card-title" style={{ marginBottom: 16 }}>Recommended Actions</div>
                                        {result.recommended_actions?.map((action, i) => (
                                            <div className="action-item" key={i}>
                                                <span className="action-icon"><Icons.ArrowRight /></span>
                                                <span className="action-text">{action}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                            
                            {result.findings?.length > 0 && (
                                <div className="card">
                                    <div className="card-title" style={{ marginBottom: 16 }}>Detailed Findings</div>
                                    {result.findings.map((finding, i) => (
                                        <div className="finding-item" key={i}>
                                            <div className="finding-header">
                                                <span className="finding-category">{finding.category}</span>
                                                <span className={`severity-badge ${getSeverityClass(finding.severity)}`}>
                                                    {finding.severity} Ã— {finding.count}
                                                </span>
                                            </div>
                                            <div className="finding-description">{finding.description}</div>
                                            {finding.examples?.length > 0 && (
                                                <div className="finding-examples">
                                                    {finding.examples.map((ex, j) => (
                                                        <span className="example-tag" key={j}>{ex}</span>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            )}
                            
                            {result.reasoning && (
                                <div className="card">
                                    <div className="card-title" style={{ marginBottom: 16 }}>Analysis Reasoning</div>
                                    <p style={{ color: 'var(--text-secondary)', fontSize: 14, lineHeight: 1.7 }}>
                                        {result.reasoning}
                                    </p>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };
        
        // Dashboard Page
        const DashboardPage = ({ refreshKey }) => {
            const [stats, setStats] = useState(null);
            const [incidents, setIncidents] = useState([]);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                loadData();
            }, [refreshKey]);
            
            const loadData = async () => {
                try {
                    const [statsRes, incidentsRes] = await Promise.all([
                        fetch(`${API_BASE}/api/stats`),
                        fetch(`${API_BASE}/api/incidents?limit=20`)
                    ]);
                    
                    if (statsRes.ok) setStats(await statsRes.json());
                    if (incidentsRes.ok) {
                        const data = await incidentsRes.json();
                        setIncidents(data.incidents || []);
                    }
                } catch (err) {
                    console.error('Failed to load dashboard data:', err);
                } finally {
                    setLoading(false);
                }
            };
            
            if (loading) {
                return (
                    <div>
                        <div className="page-header">
                            <h1 className="page-title">Dashboard</h1>
                        </div>
                        <div className="loading-spinner"></div>
                    </div>
                );
            }
            
            return (
                <div>
                    <div className="page-header">
                        <h1 className="page-title">Dashboard</h1>
                        <p className="page-subtitle">Security incident overview and analytics</p>
                    </div>
                    
                    <div className="stats-grid">
                        <div className="stat-card" style={{ '--stat-color': 'var(--accent-cyan)' }}>
                            <div className="stat-value">{stats?.total_scans || 0}</div>
                            <div className="stat-label">Total Scans</div>
                        </div>
                        <div className="stat-card" style={{ '--stat-color': 'var(--accent-red)' }}>
                            <div className="stat-value">{stats?.by_severity?.CRITICAL || 0}</div>
                            <div className="stat-label">Critical Alerts</div>
                        </div>
                        <div className="stat-card" style={{ '--stat-color': 'var(--accent-orange)' }}>
                            <div className="stat-value">{stats?.by_severity?.HIGH || 0}</div>
                            <div className="stat-label">High Risk</div>
                        </div>
                        <div className="stat-card" style={{ '--stat-color': 'var(--accent-purple)' }}>
                            <div className="stat-value">{stats?.avg_score || 0}</div>
                            <div className="stat-label">Avg. Score</div>
                        </div>
                    </div>
                    
                    <div className="card">
                        <div className="card-header">
                            <span className="card-title">Recent Incidents</span>
                        </div>
                        
                        {incidents.length === 0 ? (
                            <div className="empty-state">
                                <div className="empty-icon"><Icons.Shield /></div>
                                <div>No incidents recorded yet</div>
                                <div style={{ fontSize: 13, marginTop: 8 }}>Scan a document to see results here</div>
                            </div>
                        ) : (
                            <table className="incidents-table">
                                <thead>
                                    <tr>
                                        <th>File</th>
                                        <th>Severity</th>
                                        <th>Score</th>
                                        <th>Categories</th>
                                        <th>Departments</th>
                                        <th>Time</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {incidents.map((incident) => (
                                        <tr key={incident.id}>
                                            <td className="filename-cell">{incident.filename}</td>
                                            <td>
                                                <span className={`severity-badge ${getSeverityClass(incident.sensitivity_level)}`}>
                                                    {incident.sensitivity_level}
                                                </span>
                                            </td>
                                            <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{incident.overall_score}</td>
                                            <td>
                                                {incident.top_categories?.slice(0, 2).map((cat, i) => (
                                                    <span key={i} className="example-tag" style={{ marginRight: 4 }}>{cat}</span>
                                                ))}
                                            </td>
                                            <td>
                                                {incident.departments_affected?.slice(0, 2).map((dept, i) => (
                                                    <span key={i} style={{ marginRight: 8, color: 'var(--text-secondary)', fontSize: 12 }}>{dept}</span>
                                                ))}
                                            </td>
                                            <td className="timestamp-cell">{formatTimestamp(incident.timestamp)}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        )}
                    </div>
                    
                    {stats?.by_category && Object.keys(stats.by_category).length > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 24 }}>
                            <div className="card">
                                <div className="card-title" style={{ marginBottom: 16 }}>By Category</div>
                                {Object.entries(stats.by_category).sort((a, b) => b[1] - a[1]).map(([cat, count]) => (
                                    <div key={cat} style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0', borderBottom: '1px solid var(--border-color)' }}>
                                        <span style={{ color: 'var(--text-secondary)', fontSize: 13 }}>{cat}</span>
                                        <span style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: 14 }}>{count}</span>
                                    </div>
                                ))}
                            </div>
                            <div className="card">
                                <div className="card-title" style={{ marginBottom: 16 }}>By Department</div>
                                {Object.entries(stats.by_department).sort((a, b) => b[1] - a[1]).map(([dept, count]) => (
                                    <div key={dept} style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0', borderBottom: '1px solid var(--border-color)' }}>
                                        <span style={{ color: 'var(--text-secondary)', fontSize: 13 }}>{dept}</span>
                                        <span style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: 14 }}>{count}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // Settings Page
        const SettingsPage = ({ addToast }) => {
            const [settings, setSettings] = useState({
                api_key: '',
                model: 'claude-sonnet-4-20250514',
                max_tokens: 4096,
                auto_delete_uploads: true,
                retention_days: 30
            });
            const [models, setModels] = useState([]);
            const [loading, setLoading] = useState(true);
            const [testing, setTesting] = useState(false);
            const [apiKeyInput, setApiKeyInput] = useState('');
            
            useEffect(() => {
                loadSettings();
            }, []);
            
            const loadSettings = async () => {
                try {
                    const [settingsRes, modelsRes] = await Promise.all([
                        fetch(`${API_BASE}/api/settings`),
                        fetch(`${API_BASE}/api/models`)
                    ]);
                    
                    if (settingsRes.ok) {
                        const data = await settingsRes.json();
                        setSettings(data);
                    }
                    if (modelsRes.ok) {
                        const data = await modelsRes.json();
                        setModels(data.models || []);
                    }
                } catch (err) {
                    addToast('Failed to load settings', 'error');
                } finally {
                    setLoading(false);
                }
            };
            
            const saveSettings = async () => {
                try {
                    const payload = { ...settings };
                    if (apiKeyInput) {
                        payload.api_key = apiKeyInput;
                    }
                    
                    const res = await fetch(`${API_BASE}/api/settings`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (res.ok) {
                        addToast('Settings saved successfully', 'success');
                        setApiKeyInput('');
                        loadSettings();
                    } else {
                        throw new Error('Failed to save');
                    }
                } catch (err) {
                    addToast('Failed to save settings', 'error');
                }
            };
            
            const testConnection = async () => {
                setTesting(true);
                try {
                    const res = await fetch(`${API_BASE}/api/settings/test`, {
                        method: 'POST'
                    });
                    
                    if (res.ok) {
                        addToast('API connection successful!', 'success');
                    } else {
                        const error = await res.json();
                        throw new Error(error.detail);
                    }
                } catch (err) {
                    addToast(err.message, 'error');
                } finally {
                    setTesting(false);
                }
            };
            
            const clearIncidents = async () => {
                if (!confirm('Are you sure you want to clear all incidents?')) return;
                
                try {
                    const res = await fetch(`${API_BASE}/api/incidents`, {
                        method: 'DELETE'
                    });
                    
                    if (res.ok) {
                        addToast('All incidents cleared', 'success');
                    }
                } catch (err) {
                    addToast('Failed to clear incidents', 'error');
                }
            };
            
            if (loading) {
                return (
                    <div>
                        <div className="page-header">
                            <h1 className="page-title">Settings</h1>
                        </div>
                        <div className="loading-spinner"></div>
                    </div>
                );
            }
            
            return (
                <div>
                    <div className="page-header">
                        <h1 className="page-title">Settings</h1>
                        <p className="page-subtitle">Configure API connection and application preferences</p>
                    </div>
                    
                    <div className="card">
                        <div className="card-title" style={{ marginBottom: 24 }}>Claude API Configuration</div>
                        
                        <div className="form-group">
                            <label className="form-label">API Key</label>
                            <input 
                                type="password"
                                className="form-input"
                                placeholder={settings.api_key_set ? 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢' : 'Enter your Anthropic API key'}
                                value={apiKeyInput}
                                onChange={(e) => setApiKeyInput(e.target.value)}
                            />
                            {settings.api_key_set && (
                                <div style={{ marginTop: 8, fontSize: 12, color: 'var(--accent-green)' }}>
                                    âœ“ API key configured: {settings.api_key}
                                </div>
                            )}
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Model</label>
                            <select 
                                className="form-input form-select"
                                value={settings.model}
                                onChange={(e) => setSettings({ ...settings, model: e.target.value })}
                            >
                                {models.map((m) => (
                                    <option key={m.id} value={m.id}>{m.name} - {m.description}</option>
                                ))}
                            </select>
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Max Tokens</label>
                            <input 
                                type="number"
                                className="form-input"
                                value={settings.max_tokens}
                                onChange={(e) => setSettings({ ...settings, max_tokens: parseInt(e.target.value) })}
                                min="1000"
                                max="8192"
                            />
                        </div>
                        
                        <div style={{ display: 'flex', gap: 12, marginTop: 24 }}>
                            <button className="btn btn-primary" onClick={saveSettings}>
                                Save Settings
                            </button>
                            <button 
                                className="btn btn-secondary" 
                                onClick={testConnection}
                                disabled={testing || !settings.api_key_set}
                            >
                                {testing ? 'Testing...' : 'Test Connection'}
                            </button>
                        </div>
                    </div>
                    
                    <div className="card">
                        <div className="card-title" style={{ marginBottom: 24 }}>Data Management</div>
                        
                        <div className="form-group">
                            <label className="form-label">Retention Period (Days)</label>
                            <input 
                                type="number"
                                className="form-input"
                                value={settings.retention_days}
                                onChange={(e) => setSettings({ ...settings, retention_days: parseInt(e.target.value) })}
                                min="1"
                                max="365"
                            />
                        </div>
                        
                        <div style={{ marginTop: 24 }}>
                            <button className="btn btn-danger" onClick={clearIncidents}>
                                <Icons.Trash /> Clear All Incidents
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // Main App Component
        const App = () => {
            const [currentPage, setCurrentPage] = useState('scanner');
            const [toasts, setToasts] = useState([]);
            const [dashboardKey, setDashboardKey] = useState(0);
            
            const addToast = useCallback((message, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
            }, []);
            
            const removeToast = useCallback((id) => {
                setToasts(prev => prev.filter(t => t.id !== id));
            }, []);
            
            const handleAnalysisComplete = () => {
                setDashboardKey(prev => prev + 1);
            };
            
            return (
                <div className="app-container">
                    <nav className="sidebar">
                        <div className="logo">
                            <div className="logo-text">SentinelDLP</div>
                            <div className="logo-sub">Sensitive Data Detection</div>
                        </div>
                        <div className="nav-menu">
                            <div 
                                className={`nav-item ${currentPage === 'scanner' ? 'active' : ''}`}
                                onClick={() => setCurrentPage('scanner')}
                            >
                                <span className="nav-icon"><Icons.Scanner /></span>
                                Scanner
                            </div>
                            <div 
                                className={`nav-item ${currentPage === 'dashboard' ? 'active' : ''}`}
                                onClick={() => setCurrentPage('dashboard')}
                            >
                                <span className="nav-icon"><Icons.Dashboard /></span>
                                Dashboard
                            </div>
                            <div 
                                className={`nav-item ${currentPage === 'settings' ? 'active' : ''}`}
                                onClick={() => setCurrentPage('settings')}
                            >
                                <span className="nav-icon"><Icons.Settings /></span>
                                Settings
                            </div>
                        </div>
                    </nav>
                    
                    <main className="main-content">
                        {currentPage === 'scanner' && (
                            <ScannerPage addToast={addToast} onAnalysisComplete={handleAnalysisComplete} />
                        )}
                        {currentPage === 'dashboard' && (
                            <DashboardPage refreshKey={dashboardKey} />
                        )}
                        {currentPage === 'settings' && (
                            <SettingsPage addToast={addToast} />
                        )}
                    </main>
                    
                    <div className="toast-container">
                        {toasts.map(toast => (
                            <Toast 
                                key={toast.id}
                                message={toast.message}
                                type={toast.type}
                                onClose={() => removeToast(toast.id)}
                            />
                        ))}
                    </div>
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
